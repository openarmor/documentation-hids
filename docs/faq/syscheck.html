<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Syscheck: FAQ &#8212; OpenArmor</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    <script
      id="documentation_options"
      data-url_root="../../"
      src="../../_static/documentation_options.js"
    ></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/js/jquery-fix.js"></script>
    <script src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link
      rel="next"
      title="When the unexpected happens: FAQ"
      href="unexpected.html"
    />
    <link rel="prev" title="OpenArmor: FAQ" href="OpenArmor.html" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html"
            ><img src="../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../manual/index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul class="current">
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../programs/index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a href="OpenArmor.html" title="Previous Chapter: OpenArmor: FAQ"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; OpenArmor: FAQ</span
                >
              </a>
            </li>
            <li>
              <a
                href="unexpected.html"
                title="Next Chapter: When the unexpected happens: FAQ"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >When the unex... &raquo;</span
                >
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="syscheck-faq">
            <h1>
              Syscheck: FAQ<a
                class="headerlink"
                href="#syscheck-faq"
                title="Permalink to this headline"
                >Â¶</a
              >
            </h1>
            <div class="contents local topic" id="contents">
              <ul class="simple">
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-to-force-an-immediate-syscheck-scan"
                      id="id1"
                      >How to force an immediate syscheck scan?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-to-tell-syscheck-not-to-scan-the-system-when-OpenArmor-starts"
                      id="id2"
                      >How to tell syscheck not to scan the system when
                      OpenArmor starts?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-to-ignore-a-file-that-changes-too-often"
                      id="id3"
                      >How to ignore a file that changes too often?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#why-does-OpenArmor-still-scan-a-file-even-though-it-s-been-ignored"
                      id="id4"
                      >Why does OpenArmor still scan a file even though itâs
                      been ignored?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-to-know-when-the-syscheck-scan-ran"
                      id="id5"
                      >How to know when the syscheck scan ran?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-to-get-detailed-reporting-on-the-changes"
                      id="id6"
                      >How to get detailed reporting on the changes?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#syscheck-not-sending-any-file-data-to-the-server"
                      id="id7"
                      >Syscheck not sending any file data to the server?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#why-aren-t-new-files-creating-an-alert"
                      id="id8"
                      >Why arenât new files creating an alert?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#can-OpenArmor-include-information-on-who-changed-a-file-in-the-alert"
                      id="id9"
                      >Can OpenArmor include information on who changed a file
                      in the alert?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-do-i-stop-syscheck-alerts-during-system-updates"
                      id="id10"
                      >How do I stop syscheck alerts during system updates?</a
                    >
                  </p>
                </li>
              </ul>
            </div>
            <div class="section" id="how-to-force-an-immediate-syscheck-scan">
              <h2>
                <a class="toc-backref" href="#id1"
                  >How to force an immediate syscheck scan?</a
                ><a
                  class="headerlink"
                  href="#how-to-force-an-immediate-syscheck-scan"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Run agent control tool to perform a integrity checking
                    immediately (option -a to run on all the agents and -u to
                    specify an agent id)
                  </p>
                  <div class="highlight-console notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="gp"># </span>/var/OpenArmor/bin/agent_control -r -a
<span class="gp"># </span>/var/OpenArmor/bin/agent_control -r -u &lt;agent_id&gt;
</pre>
                    </div>
                  </div>
                  <p>
                    For more information see the
                    <a
                      class="reference internal"
                      href="../programs/agent_control.html#agent-control"
                      ><span class="std std-ref">agent_control</span></a
                    >
                    documentation.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="how-to-tell-syscheck-not-to-scan-the-system-when-OpenArmor-starts"
            >
              <h2>
                <a class="toc-backref" href="#id2"
                  >How to tell syscheck not to scan the system when OpenArmor
                  starts?</a
                ><a
                  class="headerlink"
                  href="#how-to-tell-syscheck-not-to-scan-the-system-when-OpenArmor-starts"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Set the option &lt;scan_on_start&gt; to ânoâ on
                    OpenArmor.conf
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="how-to-ignore-a-file-that-changes-too-often"
            >
              <h2>
                <a class="toc-backref" href="#id3"
                  >How to ignore a file that changes too often?</a
                ><a
                  class="headerlink"
                  href="#how-to-ignore-a-file-that-changes-too-often"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Set the file/directory name in the &lt;ignore&gt; option or
                    create a simple local rule.
                  </p>
                  <p>
                    The following one will ignore files /etc/a and /etc/b and
                    the directory /etc/dir for agents mswin1 and ubuntu-dns:
                  </p>
                  <div class="highlight-xml notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;100345&quot;</span> <span class="na">level=</span><span class="s">&quot;0&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;if_group&gt;</span>syscheck<span class="nt">&lt;/if_group&gt;</span>
    <span class="nt">&lt;description&gt;</span>Changes ignored.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;match&gt;</span>/etc/a|/etc/b|/etc/dir<span class="nt">&lt;/match&gt;</span>
    <span class="nt">&lt;hostname&gt;</span>mswin1|ubuntu-dns<span class="nt">&lt;/hostname&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                    </div>
                  </div>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="why-does-OpenArmor-still-scan-a-file-even-though-it-s-been-ignored"
            >
              <h2>
                <a class="toc-backref" href="#id4"
                  >Why does OpenArmor still scan a file even though itâs been
                  ignored?</a
                ><a
                  class="headerlink"
                  href="#why-does-OpenArmor-still-scan-a-file-even-though-it-s-been-ignored"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    No idea. So if there are some directories you do not want
                    scanned at all, make sure they are not included in a
                    <code class="docutils literal notranslate"
                      ><span class="pre">&lt;directories&gt;</span></code
                    >
                    configuration.
                  </p>
                </div>
              </blockquote>
            </div>
            <div class="section" id="how-to-know-when-the-syscheck-scan-ran">
              <h2>
                <a class="toc-backref" href="#id5"
                  >How to know when the syscheck scan ran?</a
                ><a
                  class="headerlink"
                  href="#how-to-know-when-the-syscheck-scan-ran"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Use the agent_control tool on the manager, to see this
                    information.
                  </p>
                  <p>
                    More information see the
                    <a
                      class="reference internal"
                      href="../programs/agent_control.html#agent-control"
                      ><span class="std std-ref">agent_control</span></a
                    >
                    documentation.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="how-to-get-detailed-reporting-on-the-changes"
            >
              <h2>
                <a class="toc-backref" href="#id6"
                  >How to get detailed reporting on the changes?</a
                ><a
                  class="headerlink"
                  href="#how-to-get-detailed-reporting-on-the-changes"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Use the syscheck_control tool on the manager or the web ui
                    for that.
                  </p>
                  <p>
                    More information see the
                    <a
                      class="reference internal"
                      href="../programs/syscheck_control.html#syscheck-control"
                      ><span class="std std-ref">syscheck_control</span></a
                    >
                    documentation.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="syscheck-not-sending-any-file-data-to-the-server"
            >
              <h2>
                <a class="toc-backref" href="#id7"
                  >Syscheck not sending any file data to the server?</a
                ><a
                  class="headerlink"
                  href="#syscheck-not-sending-any-file-data-to-the-server"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                With OpenArmor 1.3 and Fedora you may run into this problem:
              </p>
              <p>
                You have named files youâd like OpenArmor to monitor so you add:
              </p>
              <div class="highlight-xml notranslate">
                <div class="highlight">
                  <pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;syscheck&gt;</span>
        <span class="nt">&lt;directories</span> <span class="na">check_all=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>/var/named<span class="nt">&lt;/directories&gt;</span>
</pre>
                </div>
              </div>
              <p>
                to OpenArmor.conf on the client. Fedora â at least as of version
                7 â runs named in a chroot jail under /var/named/chroot.
                However, part of that chroot jail includes
                /var/named/chroot/proc. The contents of that directory are
                purely ephemeral; there is no value to checking their integrity.
                And, at least in OpenArmor 1.3, your syscheck may stall trying
                to read those files.
              </p>
              <p>
                The symptom is a syscheck database on the server that never
                grows beyond a file or two per restart of the client. The log
                monitoring continues to work, so you know itâs not a
                communication issue, and you will often see a slight increase in
                syscheck database file size after the client has restarted (in
                one case about 20 minutes after). But the database will never be
                completely built; there will only be a couple files listed in
                database.
              </p>
              <p>
                The solution is to add an ignore clause to OpenArmor.conf on the
                client:
              </p>
              <div class="highlight-xml notranslate">
                <div class="highlight">
                  <pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;syscheck&gt;</span>
        <span class="nt">&lt;ignore&gt;</span>/var/named/chroot/proc<span class="nt">&lt;/ignore&gt;</span>
</pre>
                </div>
              </div>
            </div>
            <div class="section" id="why-aren-t-new-files-creating-an-alert">
              <h2>
                <a class="toc-backref" href="#id8"
                  >Why arenât new files creating an alert?</a
                ><a
                  class="headerlink"
                  href="#why-aren-t-new-files-creating-an-alert"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                By default OpenArmor does not alert on new files. To enable this
                functionality, &lt;alert_new_files&gt; must be set to yes inside
                the &lt;syscheck&gt; section of the managerâs OpenArmor.conf.
                Also, the rule to alert on new files (rule 554) is set to level
                0 by default. The alert level will need to be raised in order to
                see the alert. Alerting on new files does not work in realtime,
                a full scan will be necessary to detect them.
              </p>
              <p>Add the following to local_rules.xml:</p>
              <div class="highlight-xml notranslate">
                <div class="highlight">
                  <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;554&quot;</span> <span class="na">level=</span><span class="s">&quot;10&quot;</span> <span class="na">overwrite=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;category&gt;</span>OpenArmor<span class="nt">&lt;/category&gt;</span>
  <span class="nt">&lt;decoded_as&gt;</span>syscheck_new_entry<span class="nt">&lt;/decoded_as&gt;</span>
  <span class="nt">&lt;description&gt;</span>File added to the system.<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;group&gt;</span>syscheck,<span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                </div>
              </div>
              <p>
                The
                <code class="docutils literal notranslate"
                  ><span class="pre">&lt;alert_new_files&gt;</span></code
                >
                entry should look something like this:
              </p>
              <div class="highlight-xml notranslate">
                <div class="highlight">
                  <pre><span></span><span class="nt">&lt;syscheck&gt;</span>
  <span class="nt">&lt;frequency&gt;</span>7200<span class="nt">&lt;/frequency&gt;</span>
  <span class="nt">&lt;alert_new_files&gt;</span>yes<span class="nt">&lt;/alert_new_files&gt;</span>
  <span class="nt">&lt;directories</span> <span class="na">check_all=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>/etc,/bin,/sbin<span class="nt">&lt;/directories&gt;</span>
<span class="nt">&lt;/syscheck&gt;</span>
</pre>
                </div>
              </div>
            </div>
            <div
              class="section"
              id="can-OpenArmor-include-information-on-who-changed-a-file-in-the-alert"
            >
              <h2>
                <a class="toc-backref" href="#id9"
                  >Can OpenArmor include information on who changed a file in
                  the alert?</a
                ><a
                  class="headerlink"
                  href="#can-OpenArmor-include-information-on-who-changed-a-file-in-the-alert"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                In short, no. OpenArmor does not track this information. You
                could use your OSâs auditing facilities to track this
                information, and create a rule to alert when an appropriate log
                is created.
              </p>
            </div>
            <div
              class="section"
              id="how-do-i-stop-syscheck-alerts-during-system-updates"
            >
              <h2>
                <a class="toc-backref" href="#id10"
                  >How do I stop syscheck alerts during system updates?</a
                ><a
                  class="headerlink"
                  href="#how-do-i-stop-syscheck-alerts-during-system-updates"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                There is no easy way to do this, but there are work-arounds.
                Stop the OpenArmor processes on the manager, and run
                <code class="docutils literal notranslate"
                  ><span class="pre">/var/OpenArmor/bin/syscheck_control</span>
                  <span class="pre">-u</span>
                  <span class="pre">AGENT_ID</span></code
                >. This will clear the syscheck database for the agent, and the
                next time syscheck runs it will create a new baseline. Next,
                start the OpenArmor processes on the manager. Once the system
                update is complete, run a syscheck scan on that agent. The
                database will be populated with new values, and should not
                trigger âfile modifiedâ alarms.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
