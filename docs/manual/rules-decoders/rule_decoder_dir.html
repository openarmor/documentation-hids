<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Directory path loading of rules and decoders &#8212; OpenArmor</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parallax.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../_static/js/jquery-fix.js"></script>
    <script src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Rules Classification" href="rule-levels.html" />
    <link rel="prev" title="Create Custom decoder and rules" href="create-custom.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-138780766-1');
</script>

<script type="text/javascript">
  var _ss = _ss || [];
  _ss.push(['_setDomain', 'https://koi-3QNN51VTHS.marketingautomation.services/net']);
  _ss.push(['_setAccount', 'KOI-4APYNOYP8O']);
  _ss.push(['_trackPageView']);
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  (function() {
  var ss = document.createElement('script');
  ss.type = 'text/javascript'; ss.async = true;
  ss.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0';
  var scr = document.getElementsByTagName('script')[0];
  scr.parentNode.insertBefore(ss, scr);
  })();
  </script>



  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/OpenArmor_logo_bare_small.jpg">
          OpenArmor</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://theopenarmor.org/about/">About</a></li>
                <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
                <li><a href="https://theopenarmor.org/register-for-OpenArmor/">Get OpenArmor+</a></li>
                <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syntax/index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="create-custom.html" title="Previous Chapter: Create Custom decoder and rules"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Create Custom...</span>
    </a>
  </li>
  <li>
    <a href="rule-levels.html" title="Next Chapter: Rules Classification"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Rules Classification &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="directory-path-loading-of-rules-and-decoders">
<span id="manual-rule-decoder-dir"></span><h1>Directory path loading of rules and decoders<a class="headerlink" href="#directory-path-loading-of-rules-and-decoders" title="Permalink to this headline">¶</a></h1>
<p>To allow whole directories of files to be loaded as decoders, lists, or rules
by OpenArmor-anaylistd.</p>
<div class="section" id="use-case">
<h2>Use case<a class="headerlink" href="#use-case" title="Permalink to this headline">¶</a></h2>
<p>Greatly simplifies working with decoders as there can be as many files as needed.
Also will make packaging of rules and decoders a simple unzip/untar and restart
operation. This will also greatly reduce the amount of code needed to manage
the upgrade scripts of OpenArmor.</p>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="syntax-for-OpenArmor">
<h3>Syntax for OpenArmor<a class="headerlink" href="#syntax-for-OpenArmor" title="Permalink to this headline">¶</a></h3>
<p>All Directory loading is done in alphabetical form. This is much like init.d
where the use of numeric prefixes on file names can affect the order of
loading. Example of file names and the order they would be loaded:</p>
<ol class="arabic simple">
<li><p>00_sshd_rules.xml</p></li>
<li><p>01_local_sshd_rules.xml</p></li>
<li><p>99_shun_rules.xml</p></li>
</ol>
<div class="section" id="directory-loading">
<h4>Directory loading<a class="headerlink" href="#directory-loading" title="Permalink to this headline">¶</a></h4>
<p>The basic format for selection of rules file is as follows. This will load all
files in the rules dir that match the regex <code class="docutils literal notranslate"><span class="pre">_rules.xml$</span></code>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;rule_dir</span> <span class="na">pattern=</span><span class="s">&quot;_rules.xml&quot;</span><span class="nt">&gt;</span>rules<span class="nt">&lt;/rule_dir&gt;</span>
</pre></div>
</div>
<p>The pattern is optional and defaults to _rules.xml for rules loading so this
could be written as:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;rule_dir&gt;</span>rules<span class="nt">&lt;/rule_dir&gt;</span>
</pre></div>
</div>
<p>Order of the directives in OpenArmor.conf is still respected, and duplicate files
will not be loaded. In the following example 00_setup_rules.xml is always
loaded first, and will <em>NOT</em> be loaded a second time by the rule_dir
directive.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;include&gt;</span>rules/00_setup_rules.xml<span class="nt">&lt;/include&gt;</span>
        <span class="nt">&lt;rule_dir&gt;</span>rules<span class="nt">&lt;/rule_dir&gt;</span>
</pre></div>
</div>
<p>For full details on all the Syntax see <a href="#id1"><span class="problematic" id="id2">:xml:`rule_dir`</span></a> and <a href="#id3"><span class="problematic" id="id4">:xml:`decoder_dir`</span></a></p>
</div>
</div>
<div class="section" id="compete-examples-of-syntax">
<h3>Compete Examples of syntax<a class="headerlink" href="#compete-examples-of-syntax" title="Permalink to this headline">¶</a></h3>
<p>This is an example where the decoders and rules have been broken out into
subdirectories.</p>
<ul>
<li><p>rules/</p>
<blockquote>
<div><ul>
<li><p>00_rules_config.xml</p></li>
<li><p>50_apache_rules.xml</p></li>
<li><p>50_arpwatch_rules.xml</p></li>
<li><p>plugins/</p>
<blockquote>
<div><ul class="simple">
<li><p>50_wimax_rules.xml</p></li>
<li><p>50_wimax_decoders.xml</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>etc/</p>
<blockquote>
<div><ul class="simple">
<li><p>decoder.xml</p></li>
<li><p>local_decoder.xml</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;OpenArmor_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;decoder&gt;</span>etc/decoder.xml<span class="nt">&lt;/decoder&gt;</span>
        <span class="nt">&lt;decoder_dir&gt;</span>rules/plugins<span class="nt">&lt;/decoder_dir&gt;</span>

        <span class="nt">&lt;rule&gt;</span>rules/rules/00_rules_config.xml<span class="nt">&lt;/rule&gt;</span>
        <span class="nt">&lt;rule_dir</span> <span class="na">pattern=</span><span class="s">&quot;.xml$&quot;</span><span class="nt">&gt;</span>rules/<span class="nt">&lt;/rule_dir&gt;</span>
        <span class="nt">&lt;rule_dir&gt;</span>rules/plugins<span class="nt">&lt;/rule_dir&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/OpenArmor_config&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021, OpenArmor Project Team.<br/>
    OpenArmor <b>OpenArmor.net</b> domain owned and maintained by <a href="https://theopenarmor.org" target="_blank">OpenArmor Foundation</a><br/>
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>