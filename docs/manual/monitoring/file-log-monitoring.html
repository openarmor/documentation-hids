<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>File Monitoring &#8212; OpenArmor</title>
    <link
      rel="stylesheet"
      href="../../../_static/pygments.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/parallax.css"
      type="text/css"
    />
    <script
      id="documentation_options"
      data-url_root="../../../"
      src="../../../_static/documentation_options.js"
    ></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../_static/js/jquery-fix.js"></script>
    <script src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../_static/bootstrap-sphinx.js"></script>
    <link
      rel="author"
      title="About these documents"
      href="../../../about.html"
    />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Syscheck" href="../syscheck/index.html" />
    <link
      rel="prev"
      title="Process Monitoring"
      href="process-monitoring.html"
    />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../index.html"
            ><img src="../../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul class="current">
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="../index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../faq/index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../programs/index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a
                href="process-monitoring.html"
                title="Previous Chapter: Process Monitoring"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; Process Monitoring</span
                >
              </a>
            </li>
            <li>
              <a href="../syscheck/index.html" title="Next Chapter: Syscheck"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet">Syscheck &raquo;</span>
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="file-monitoring">
            <span id="manual-filemon"></span>
            <h1>
              File Monitoring<a
                class="headerlink"
                href="#file-monitoring"
                title="Permalink to this headline"
                >¶</a
              >
            </h1>
            <div class="section" id="overview">
              <h2>
                Overview<a
                  class="headerlink"
                  href="#overview"
                  title="Permalink to this headline"
                  >¶</a
                >
              </h2>
              <p>
                OpenArmor has a process named
                <code class="docutils literal notranslate"
                  ><span class="pre">OpenArmor-logcollector</span></code
                >
                that monitors the configured log files for new events. When new
                log messages arrive, it forwards them to other processes for
                analysis or transport to an OpenArmor server.
              </p>
            </div>
            <div class="section" id="configuration">
              <h2>
                Configuration<a
                  class="headerlink"
                  href="#configuration"
                  title="Permalink to this headline"
                  >¶</a
                >
              </h2>
              <p>
                The configuration for OpenArmor-logcollector exists in
                <code class="docutils literal notranslate"
                  ><span class="pre"
                    >/var/OpenArmor/etc/OpenArmor.conf</span
                  ></code
                >
                in the
                <code class="docutils literal notranslate"
                  ><span class="pre">&lt;OpenArmor_config&gt;</span></code
                >
                section. The syntax can be found in the
                <a
                  class="reference external"
                  href="../../syntax/head_OpenArmor_config.localfile.html"
                  >localfile syntax page</a
                >
              </p>
            </div>
            <div class="section" id="configuration-examples">
              <h2>
                Configuration examples<a
                  class="headerlink"
                  href="#configuration-examples"
                  title="Permalink to this headline"
                  >¶</a
                >
              </h2>
              <div class="section" id="simple-example">
                <h3>
                  Simple example<a
                    class="headerlink"
                    href="#simple-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  Configuring a log file to be monitored is simple. Just provide
                  the name of the file to be monitored and the format:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>/var/log/messages<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>syslog<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="windows-eventlog-example">
                <h3>
                  Windows EventLog Example<a
                    class="headerlink"
                    href="#windows-eventlog-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  To monitor a Windows event log, you need to provide the format
                  as “eventlog” and the location is the name of the event log.
                  Example:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>Security<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>eventlog<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="windows-eventchannel-example">
                <h3>
                  Windows EventChannel Example<a
                    class="headerlink"
                    href="#windows-eventchannel-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  To monitor a Windows event log on Windows Vista or later, you
                  have the possibility to use the “eventchannel” log format. The
                  location is the name of the event log. This is the only way to
                  monitor Applications and Services logs. If the file name
                  contains a “%4”, replace it with “/”. Example:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>Microsoft-Windows-PrintService/Operational<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>eventchannel<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="multiple-files-example">
                <h3>
                  Multiple Files Example<a
                    class="headerlink"
                    href="#multiple-files-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  To check multiple files, OpenArmor supports posix regular
                  expressions. For example, to analyze every file that ends with
                  a .log inside the /var/log directory, use the following
                  configuration:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>/var/log/*.log<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>syslog<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="date-based-example">
                <h3>
                  Date Based Example<a
                    class="headerlink"
                    href="#date-based-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  For log files that change according to the date, you can also
                  specify a strftime format to replace the day, month, year,
                  etc. For example, to monitor the log
                  C:\Windows\app\log-08-12-15.log, where 08 is the year, 12 is
                  the month and 15 the day (and it is rolled over every day),
                  do:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>C:\Windows\app\log-%y-%m-%d.log<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>syslog<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
                <div class="admonition warning">
                  <p class="admonition-title">Warning</p>
                  <p>
                    Wildcards cannot be combined with the date based format.
                  </p>
                </div>
              </div>
              <div class="section" id="iis-logs-example">
                <h3>
                  IIS Logs Example<a
                    class="headerlink"
                    href="#iis-logs-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  Support for IIS (5 and 6) is available for the NCSA format
                  (web only) and the W3C extended format (for Web, FTP and
                  SMTP). By default, the installation scripts will attempt to
                  configure OpenArmor to monitor the first virtual hosts for web
                  (W3SVC1 to W3SVC254), ftp (MSFTPSVC1 to MSFTPSVC254) and smtp
                  (SMTPSVC1 to SMTPSVC254). To monitor any other file you need
                  to add a new entry manually.
                </p>
                <p>
                  In addition to that, make sure to set the log time period to
                  daily.
                </p>
                <img
                  alt="../../../_images/w3c-opt1.jpg"
                  src="../../../_images/w3c-opt1.jpg"
                />
                <p>And using the local time for file naming and rollover.</p>
                <img
                  alt="../../../_images/w3c-opt3.jpg"
                  src="../../../_images/w3c-opt3.jpg"
                />
                <p>
                  In the extended logging properties, configure it to log the
                  Date, Time and all the extended properties.
                </p>
                <img
                  alt="../../../_images/w3c-opt2.jpg"
                  src="../../../_images/w3c-opt2.jpg"
                />
                <p>
                  The following is an example of configuration to monitor the
                  virtual server 2 of IIS web
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;location&gt;</span>%WinDir%\System32\LogFiles\W3SVC3\ex%y%m%d.log<span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>iis<span class="nt">&lt;/log_format&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
