<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rootcheck_control &#8212; OpenArmor</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    <script
      id="documentation_options"
      data-url_root="../../"
      src="../../_static/documentation_options.js"
    ></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/js/jquery-fix.js"></script>
    <script src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="syscheck_control" href="syscheck_control.html" />
    <link
      rel="prev"
      title="OpenArmor-syscheckd"
      href="OpenArmor-syscheckd.html"
    />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html"
            ><img src="../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../manual/index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../faq/index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul class="current">
                  <li class="toctree-l1">
                    <a class="reference internal" href="../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a
                href="OpenArmor-syscheckd.html"
                title="Previous Chapter: OpenArmor-syscheckd"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; OpenArmor-syscheckd</span
                >
              </a>
            </li>
            <li>
              <a
                href="syscheck_control.html"
                title="Next Chapter: syscheck_control"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >syscheck_control &raquo;</span
                >
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="rootcheck-control">
            <span id="id1"></span>
            <h1>
              rootcheck_control<a
                class="headerlink"
                href="#rootcheck-control"
                title="Permalink to this headline"
                >Â¶</a
              >
            </h1>
            <p>
              The rootcheck_control tool allows you to manage the policy
              monitoring and system auditing database that is stored on the
              server (manager) side. You can list anomalies detected by the
              rootcheck functionality, categorized into resolved and outstanding
              issues. Moreover you can find out when OpenArmor-rootcheck was run
              the last time.
            </p>
            <div class="section" id="rootcheck-control-argument-options">
              <h2>
                rootcheck_control argument options<a
                  class="headerlink"
                  href="#rootcheck-control-argument-options"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-h">
                  <span id="cmdoption-rootcheck-control-h"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-h</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-h"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Display the help message.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-l">
                  <span id="cmdoption-rootcheck-control-l"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-l</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-l"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>List available agents.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-lc">
                  <span id="cmdoption-rootcheck-control-lc"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-lc</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-lc"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>List only currently connected agents.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-u">
                  <span id="cmdoption-rootcheck-control-u"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-u</span></code
                  ><code class="sig-prename descclassname">
                    <span class="pre">&lt;id&gt;</span></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-u"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd>
                  <p>
                    Updates (clear) the database for the agent.
                    <cite>&lt;id&gt;</cite> can be an agent ID or
                    <cite>all</cite> to cleare the database for all agents.
                  </p>
                </dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-i">
                  <span id="cmdoption-rootcheck-control-i"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-i</span></code
                  ><code class="sig-prename descclassname">
                    <span class="pre">AGENT_ID</span></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-i"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Prints database for the agent.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-r">
                  <span id="cmdoption-rootcheck-control-r"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-r</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-r"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Used with -i, prints all the resolved issues.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-q">
                  <span id="cmdoption-rootcheck-control-q"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-q</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-q"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Used with -i, prints all the outstanding issues.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-L">
                  <code class="sig-name descname"
                    ><span class="pre">-L</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-L"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Used with -i, prints the last scan.</p></dd>
              </dl>

              <dl class="std option">
                <dt id="cmdoption-rootcheck_control-s">
                  <span id="cmdoption-rootcheck-control-s"></span
                  ><code class="sig-name descname"
                    ><span class="pre">-s</span></code
                  ><code class="sig-prename descclassname"></code
                  ><a
                    class="headerlink"
                    href="#cmdoption-rootcheck_control-s"
                    title="Permalink to this definition"
                    >Â¶</a
                  >
                </dt>
                <dd><p>Changes the output to CSV (comma delimited).</p></dd>
              </dl>
            </div>
            <div class="section" id="rootcheck-control-example-usage">
              <h2>
                rootcheck_control example usage<a
                  class="headerlink"
                  href="#rootcheck-control-example-usage"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <div
                class="section"
                id="example-1-getting-a-list-of-system-auditing-policy-monitoring-events"
              >
                <h3>
                  Example 1: Getting a list of system auditing/policy monitoring
                  events<a
                    class="headerlink"
                    href="#example-1-getting-a-list-of-system-auditing-policy-monitoring-events"
                    title="Permalink to this headline"
                    >Â¶</a
                  >
                </h3>
                <p>
                  To get a list of all auditing/policy monitoring events for a
                  specific agent, you can run
                  <cite>rootcheck_control -i &lt;agent_id&gt;</cite>. To
                  retrieve the agent id you can use any of the following
                  commands:
                </p>
                <ul class="simple">
                  <li>
                    <p>
                      <a
                        class="reference internal"
                        href="#cmdoption-rootcheck_control-l"
                        ><code
                          class="xref std std-option docutils literal notranslate"
                          ><span class="pre">rootcheck_control</span>
                          <span class="pre">-l</span></code
                        ></a
                      >,
                    </p>
                  </li>
                  <li>
                    <p>
                      <a
                        class="reference internal"
                        href="agent_control.html#cmdoption-agent_control-l"
                        ><code
                          class="xref std std-option docutils literal notranslate"
                          ><span class="pre">agent_control</span>
                          <span class="pre">-l</span></code
                        ></a
                      >
                    </p>
                  </li>
                  <li>
                    <p>
                      <a
                        class="reference internal"
                        href="syscheck_control.html#cmdoption-syscheck_control-l"
                        ><code
                          class="xref std std-option docutils literal notranslate"
                          ><span class="pre">syscheck_control</span>
                          <span class="pre">-l</span></code
                        ></a
                      >
                    </p>
                  </li>
                  <li>
                    <p>
                      <a
                        class="reference internal"
                        href="syscheck_update.html#cmdoption-syscheck_update-l"
                        ><code
                          class="xref std std-option docutils literal notranslate"
                          ><span class="pre">syscheck_update</span>
                          <span class="pre">-l</span></code
                        ></a
                      >
                    </p>
                  </li>
                  <li>
                    <p>
                      <a
                        class="reference internal"
                        href="manage_agents.html#cmdoption-manage_agents-l"
                        ><code
                          class="xref std std-option docutils literal notranslate"
                          ><span class="pre">manage_agents</span>
                          <span class="pre">-l</span></code
                        ></a
                      >
                    </p>
                  </li>
                </ul>
                <div class="highlight-console notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="gp"># </span>/var/OpenArmor/bin/rootcheck_control -i <span class="m">002</span>

<span class="go">Policy and auditing events for agent &#39;OpenArmoragent (002) - 192.168.1.86&#39;:</span>

<span class="go">Resolved events:</span>

<span class="go">2010 Jun 15 13:01:22 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 8.8 - GRUB Password not set. File: /boot/grub/menu.lst. Reference: http://theopenarmor.org/wiki/index.php/CIS_DebianLinux .</span>


<span class="go">Outstanding events:</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Testing against the CIS Debian Linux Benchmark v1.0. File: /etc/debian_version. Reference: http://theopenarmor.org/wiki/index.php/CIS_DebianLinux .</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 1.4 - Robust partition scheme - /tmp is not on its own partition. File: /etc/fstab. Reference: http://theopenarmor.org/wiki/index.php/CIS_DebianLinux .</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 2.3 - SSH Configuration - Root login allowed. File: /etc/ssh/sshd_config. Reference: http://theopenarmor.org/wiki/index.php/CIS_DebianLinux .</span>
</pre>
                  </div>
                </div>
                <p>
                  As you can see the detected events are shown in two
                  categories, resolved events and outstanding event. To only
                  show resolved events, run
                  <cite>rootcheck_control -ri AGENT_ID</cite>. To only show
                  outstanding events, run
                  <cite>rootcheck_control -qi AGENT_ID</cite>. To only show the
                  results of the last scan and time of that scan, run
                  <cite>rootcheck_control -Li AGENT_ID</cite>.
                </p>
                <p>
                  To gain that kind of information for the OpenArmor server, run
                  <cite>rootcheck_control -i 000</cite>.
                </p>
              </div>
              <div
                class="section"
                id="example-2-clearing-the-system-auditing-policy-database"
              >
                <h3>
                  Example 2: Clearing the system auditing/policy database<a
                    class="headerlink"
                    href="#example-2-clearing-the-system-auditing-policy-database"
                    title="Permalink to this headline"
                    >Â¶</a
                  >
                </h3>
                <p>
                  To clear the system auditing/policy monitoring database for a
                  certain agent run the following command:
                </p>
                <div class="highlight-console notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="gp"># </span>/var/OpenArmor/bin/rootcheck_control -u <span class="m">002</span>

<span class="go">** Policy and auditing database updated.</span>
</pre>
                  </div>
                </div>
                <p>
                  To clear the database for all agents and the server run the
                  following command:
                </p>
                <div class="highlight-console notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="gp"># </span>/var/OpenArmor/bin/rootcheck_control -u all

<span class="go">** Policy and auditing database updated.</span>
</pre>
                  </div>
                </div>
                <p>
                  The next time rootcheck is run, the database will be populated
                  again.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
