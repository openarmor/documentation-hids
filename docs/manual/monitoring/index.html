<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log monitoring/analysis &#8212; OpenArmor</title>
    <link
      rel="stylesheet"
      href="../../../_static/pygments.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/parallax.css"
      type="text/css"
    />
    <script
      id="documentation_options"
      data-url_root="../../../"
      src="../../../_static/documentation_options.js"
    ></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../_static/js/jquery-fix.js"></script>
    <script src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../_static/bootstrap-sphinx.js"></script>
    <link
      rel="author"
      title="About these documents"
      href="../../../about.html"
    />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link
      rel="next"
      title="Process Monitoring"
      href="process-monitoring.html"
    />
    <link
      rel="prev"
      title="Writing Agentless Scripts"
      href="../agent/agentless-scripts.html"
    />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../index.html"
            ><img src="../../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul class="current">
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="../index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../faq/index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../programs/index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a
                href="../agent/agentless-scripts.html"
                title="Previous Chapter: Writing Agentless Scripts"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; Writing Agent...</span
                >
              </a>
            </li>
            <li>
              <a
                href="process-monitoring.html"
                title="Next Chapter: Process Monitoring"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >Process Monitoring &raquo;</span
                >
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="log-monitoring-analysis">
            <span id="manual-analysis"></span>
            <h1>
              Log monitoring/analysis<a
                class="headerlink"
                href="#log-monitoring-analysis"
                title="Permalink to this headline"
                >Â¶</a
              >
            </h1>
            <p>
              Log Analysis (or log inspection) is done inside OpenArmor by the
              logcollector and analysisd processes. The first one collects the
              events and the second one analyzes (decodes, filters and
              classifies) them.
            </p>
            <p>
              It is done in real time, so as soon as an event is written
              OpenArmor will process them. OpenArmor can read events from
              internal log files, from the Windows event log and also receive
              them directly via remote syslog.
            </p>
            <div class="section" id="what-is-log-analysis">
              <h2>
                What is log analysis?<a
                  class="headerlink"
                  href="#what-is-log-analysis"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                Inside OpenArmor we call log analysis a LIDS, or log-based
                intrusion detection. The goal is to detect attacks, misuse or
                system errors using the logs.
              </p>
              <p>
                LIDS - Log-based intrusion detection or security log analysis
                are the processes or techniques used to detect attacks on a
                specific network, system or application using logs as the
                primary source of information. It is also very useful to detect
                software misuse, policy violations and other forms of
                inappropriate activities.
              </p>
            </div>
            <div class="section" id="quick-facts">
              <h2>
                Quick Facts<a
                  class="headerlink"
                  href="#quick-facts"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <ul class="simple">
                <li>
                  <p>How often are logs monitored?</p>
                  <ul>
                    <li><p>In real time.</p></li>
                  </ul>
                </li>
                <li>
                  <p>Where are the events analyzed?</p>
                  <ul>
                    <li><p>In the manager.</p></li>
                  </ul>
                </li>
                <li>
                  <p>How long are they stored?</p>
                  <ul>
                    <li>
                      <p>
                        For as long as your policy dictates (it is user
                        configurable).
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>Where does this help me with compliance?</p>
                  <ul>
                    <li>
                      <p>
                        (PCI DSS, etc) It helps with the whole section 10 (log
                        monitoring) of PCI.
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>How much CPU does it use?</p>
                  <ul>
                    <li>
                      <p>
                        On the agent, it uses very little CPU/memory since it
                        just read the events and forwards them to the manager.
                      </p>
                    </li>
                    <li>
                      <p>
                        On the manager, it depends on the number of events per
                        second (EPS).
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>How does it deal with false positives?</p>
                  <ul>
                    <li>
                      <p>
                        False positives can be eliminated using local rules.
                      </p>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
            <div class="section" id="configuration-options">
              <h2>
                Configuration Options<a
                  class="headerlink"
                  href="#configuration-options"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                These options should be specified locally in each agentâs
                OpenArmor.conf file or the share agent.conf. Inside the
                <code class="docutils literal notranslate"
                  ><span class="pre">&lt;localfile&gt;</span></code
                >
                element, you can have the following options.
              </p>
            </div>
            <div class="section" id="monitoring-logs">
              <h2>
                Monitoring logs<a
                  class="headerlink"
                  href="#monitoring-logs"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <p>
                With in OpenArmor there are two major methods for monitoring
                logs: file and process. Each method has its own page and
                examples.
              </p>
              <div class="toctree-wrapper compound">
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="process-monitoring.html"
                      >Process Monitoring</a
                    >
                    <ul>
                      <li class="toctree-l2">
                        <a
                          class="reference internal"
                          href="process-monitoring.html#overview"
                          >Overview</a
                        >
                      </li>
                      <li class="toctree-l2">
                        <a
                          class="reference internal"
                          href="process-monitoring.html#configuration-examples"
                          >Configuration examples</a
                        >
                        <ul>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="process-monitoring.html#disk-space-utilization-df-h-example"
                              >Disk space utilization (df -h) example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="process-monitoring.html#load-average-uptime-example"
                              >Load average (uptime) Example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="process-monitoring.html#alerting-when-output-of-a-command-changes"
                              >Alerting when output of a command changes</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="process-monitoring.html#detecting-usb-storage-usage"
                              >Detecting USB Storage Usage</a
                            >
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="file-log-monitoring.html"
                      >File Monitoring</a
                    >
                    <ul>
                      <li class="toctree-l2">
                        <a
                          class="reference internal"
                          href="file-log-monitoring.html#overview"
                          >Overview</a
                        >
                      </li>
                      <li class="toctree-l2">
                        <a
                          class="reference internal"
                          href="file-log-monitoring.html#configuration"
                          >Configuration</a
                        >
                      </li>
                      <li class="toctree-l2">
                        <a
                          class="reference internal"
                          href="file-log-monitoring.html#configuration-examples"
                          >Configuration examples</a
                        >
                        <ul>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#simple-example"
                              >Simple example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#windows-eventlog-example"
                              >Windows EventLog Example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#windows-eventchannel-example"
                              >Windows EventChannel Example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#multiple-files-example"
                              >Multiple Files Example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#date-based-example"
                              >Date Based Example</a
                            >
                          </li>
                          <li class="toctree-l3">
                            <a
                              class="reference internal"
                              href="file-log-monitoring.html#iis-logs-example"
                              >IIS Logs Example</a
                            >
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
