<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log samples from SquirrelMail &#8212; OpenArmor</title>
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/parallax.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../../_static/js/jquery-fix.js"></script>
    <script src="../../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-138780766-1');
</script>

<script type="text/javascript">
  var _ss = _ss || [];
  _ss.push(['_setDomain', 'https://koi-3QNN51VTHS.marketingautomation.services/net']);
  _ss.push(['_setAccount', 'KOI-4APYNOYP8O']);
  _ss.push(['_trackPageView']);
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  (function() {
  var ss = document.createElement('script');
  ss.type = 'text/javascript'; ss.async = true;
  ss.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0';
  var scr = document.getElementsByTagName('script')[0];
  scr.parentNode.insertBefore(ss, scr);
  })();
  </script>



  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html"><img src="../../../../_static/OpenArmor_logo_bare_small.jpg">
          OpenArmor</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://theopenarmor.org/about/">About</a></li>
                <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
                <li><a href="https://theopenarmor.org/register-for-OpenArmor/">Get OpenArmor+</a></li>
                <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../syntax/index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="log-samples-from-squirrelmail">
<h1>Log samples from SquirrelMail<a class="headerlink" href="#log-samples-from-squirrelmail" title="Permalink to this headline">¶</a></h1>
<p>SquirrelMail mostly connects with IMAP server 127.0.0.1 and the only one place where is information about client host is the Apache web server log. Successful login returns error code 302 (Found - redirection), unsuccessful login returns error code 200 (OK).</p>
<div class="section" id="login-successful">
<h2>Login successful:<a class="headerlink" href="#login-successful" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">192.168.1.99 - - [10/Jul/2009:11:30:17 +0200] &quot;POST /webmail/src/redirect.php HTTP/1.0&quot; 302 - &quot;http://my_mail_host/webmail/src/login.php&quot; &quot;Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.1) Gecko/20090630 Fedora/3.5-1.fc11 Firefox/3.5&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="login-unsuccessful">
<h2>Login unsuccessful:<a class="headerlink" href="#login-unsuccessful" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">192.168.1.99 - - [09/Jul/2009:15:26:58 +0200] &quot;POST /webmail/src/redirect.php HTTP/1.0&quot; 200 1105 &quot;http://my_mail_host/webmail/src/login.php&quot; &quot;Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.1) Gecko/20090630 Fedora/3.5-1.fc11 Firefox/3.5&quot;</span>
</pre></div>
</div>
<p>Corresponding lines from /var/log/maillog:</p>
</div>
<div class="section" id="success">
<h2>Success:<a class="headerlink" href="#success" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Jul 10 11:30:17 srv vpopmail[3676]: vchkpw-webmail: (PLAIN) login success mail_account:127.0.0.1</span>
<span class="go">Jul 10 11:30:17 srv dovecot: imap-login: Login: user=&lt;mail_account&gt;, method=PLAIN, rip=127.0.0.1, lip=127.0.0.1, secured</span>
</pre></div>
</div>
</div>
<div class="section" id="failure">
<h2>Failure:<a class="headerlink" href="#failure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Jul  9 15:26:58 srv vpopmail[16745]: vchkpw-webmail: password fail (pass: &#39;test&#39;) mail_account:127.0.0.1</span>
<span class="go">Jul  9 15:27:00 srv dovecot: imap-login: Aborted login (auth failed, 1 attempts): user=&lt;mail_account&gt;, method=PLAIN, rip=127.0.0.1, lip=127.0.0.1, secured</span>
</pre></div>
</div>
</div>
<div class="section" id="my-local-rules">
<h2>My local rules:<a class="headerlink" href="#my-local-rules" title="Permalink to this headline">¶</a></h2>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;squirrelmail,&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131100&quot;</span> <span class="na">level=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>31108<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;url&gt;</span>/webmail/src/redirect.php<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail logins grouped.<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131101&quot;</span> <span class="na">level=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>131100<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;id&gt;</span>^302<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail: successfull login.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>authentication_success,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131102&quot;</span> <span class="na">level=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>131100<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;id&gt;</span>^200<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail: authentication failed.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>authentication_failures,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131103&quot;</span> <span class="na">level=</span><span class="s">&quot;10&quot;</span> <span class="na">frequency=</span><span class="s">&quot;6&quot;</span> <span class="na">timeframe=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_matched_sid&gt;</span>131102<span class="nt">&lt;/if_matched_sid&gt;</span>
    <span class="nt">&lt;same_source_ip</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail brute force attack.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>attack, authentication_failures,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>
<span class="nt">&lt;/group&gt;</span> <span class="c">&lt;!-- SQUIRRELMAIL --&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="separate-group-squirrelmail-allowing-to-get-report-about-webmail-logins">
<h2>Separate group “squirrelmail” allowing to get report about webmail logins:<a class="headerlink" href="#separate-group-squirrelmail-allowing-to-get-report-about-webmail-logins" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat /var/OpenArmor/logs/alerts/alerts.log|/var/OpenArmor/bin/OpenArmor-reportd -f group squirrelmail</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021, OpenArmor Project Team.<br/>
    OpenArmor <b>OpenArmor.net</b> domain owned and maintained by <a href="https://theopenarmor.org" target="_blank">OpenArmor Foundation</a><br/>
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>