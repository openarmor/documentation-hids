<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alerts: FAQ &#8212; OpenArmor</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    <script
      id="documentation_options"
      data-url_root="../../"
      src="../../_static/documentation_options.js"
    ></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/js/jquery-fix.js"></script>
    <script src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Installation: FAQ" href="installation.html" />
    <link rel="prev" title="Agents: FAQ" href="agents.html" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html"
            ><img src="../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../manual/index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul class="current">
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../programs/index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a href="agents.html" title="Previous Chapter: Agents: FAQ"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; Agents: FAQ</span
                >
              </a>
            </li>
            <li>
              <a
                href="installation.html"
                title="Next Chapter: Installation: FAQ"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >Installation: FAQ &raquo;</span
                >
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="alerts-faq">
            <span id="faq-alerts"></span>
            <h1>
              Alerts: FAQ<a
                class="headerlink"
                href="#alerts-faq"
                title="Permalink to this headline"
                >Â¶</a
              >
            </h1>
            <div class="contents local topic" id="contents">
              <ul class="simple">
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-do-you-monitor-for-usb-storage"
                      id="id1"
                      >How do you monitor for usb storage?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#why-do-i-see-alerts-for-agent2-in-an-email-about-agent1"
                      id="id2"
                      >Why do I see alerts for agent2 in an email about
                      agent1?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening"
                      id="id3"
                      >Alerts for different sensors are appearing in the same
                      email, how do I stop this from happening?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#how-do-i-ignore-rule-1002"
                      id="id4"
                      >How do I ignore rule 1002?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels"
                      id="id5"
                      >I set the &lt;email_alert_level&gt; to 10, why do I keep
                      seeing rules with lower levels?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#why-are-all-of-my-windows-alerts-showing-up-as-rule-1002"
                      id="id6"
                      >Why are all of my Windows alerts showing up as rule
                      1002?</a
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <a
                      class="reference internal"
                      href="#i-keep-getting-log-messages-that-start-with-mark-what-do-i-do"
                      id="id7"
                      >I keep getting log messages that start with
                      <code class="docutils literal notranslate"
                        ><span class="pre">--MARK</span></code
                      >, what do I do?</a
                    >
                  </p>
                </li>
              </ul>
            </div>
            <div class="section" id="how-do-you-monitor-for-usb-storage">
              <span id="usb-storage"></span>
              <h2>
                <a class="toc-backref" href="#id1"
                  >How do you monitor for usb storage?</a
                ><a
                  class="headerlink"
                  href="#how-do-you-monitor-for-usb-storage"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    The first step is to configure the agents to check a
                    registry entry with the
                    <code class="docutils literal notranslate"
                      ><span class="pre">reg</span></code
                    >
                    command:
                  </p>
                  <div class="highlight-xml notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="nt">&lt;agent_config</span> <span class="na">os=</span><span class="s">&quot;Windows&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>full_command<span class="nt">&lt;/log_format&gt;</span>
    <span class="nt">&lt;command&gt;</span>reg QUERY HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR<span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;alias&gt;</span>usb-check<span class="nt">&lt;/alias&gt;</span>
  <span class="nt">&lt;/localfile&gt;</span>
<span class="nt">&lt;/agent_config&gt;</span>
</pre>
                    </div>
                  </div>
                  <p>Next create a local rule for that command:</p>
                  <div class="highlight-xml notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;140125&quot;</span> <span class="na">level=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;if_sid&gt;</span>530<span class="nt">&lt;/if_sid&gt;</span>
  <span class="nt">&lt;match&gt;</span>OpenArmor: output: &#39;usb-check&#39;:<span class="nt">&lt;/match&gt;</span>
  <span class="nt">&lt;check_diff</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;description&gt;</span>New USB device connected<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                    </div>
                  </div>
                  <p>
                    When a USB drive is inserted into a Windows machine, an
                    alert will not be triggered. The alert will contain a diff
                    of the registry entry before the USB device was inserted and
                    after.
                  </p>
                  <p>
                    Originally from: â<a
                      class="reference external"
                      href="http://dcid.me/2010/03/detecting-usb-storage-usage-with-OpenArmor/"
                      >http://dcid.me/2010/03/detecting-usb-storage-usage-with-OpenArmor/</a
                    >â
                  </p>
                  <p>
                    Additional data from: â<a
                      class="reference external"
                      href="http://blog.rootshell.be/2010/03/15/detecting-usb-storage-usage-with-OpenArmor/"
                      >http://blog.rootshell.be/2010/03/15/detecting-usb-storage-usage-with-OpenArmor/</a
                    >â
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="why-do-i-see-alerts-for-agent2-in-an-email-about-agent1"
            >
              <span id="grouped-email-alerts"></span>
              <h2>
                <a class="toc-backref" href="#id2"
                  >Why do I see alerts for agent2 in an email about agent1?</a
                ><a
                  class="headerlink"
                  href="#why-do-i-see-alerts-for-agent2-in-an-email-about-agent1"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    When an email is being prepared alerts will be grouped
                    together. The only real criteria for grouping alerts
                    together is the timeframe. To prevent alerts from being
                    grouped together you can set
                    <code class="docutils literal notranslate"
                      ><span class="pre">maild.groupping</span></code
                    >
                    to 0 in
                    <code class="docutils literal notranslate"
                      ><span class="pre"
                        >/var/OpenArmor/etc/internal_options.conf</span
                      ></code
                    >. If this is set, alerts will be sent out individually. By
                    default OpenArmor will only send 12 emails per hour. To
                    increase this limit, modify or add the
                    &lt;email_maxperhour&gt; setting in the
                    <code class="docutils literal notranslate"
                      ><span class="pre">&lt;global&gt;</span></code
                    >
                    section of the
                    <code class="docutils literal notranslate"
                      ><span class="pre">OpenArmor.conf</span></code
                    >. (see:
                    <a
                      class="reference external"
                      href="../syntax/head_OpenArmor_config.global.html#element-email_maxperhour"
                      >email_maxperhour</a
                    >
                    .)
                  </p>
                  <div class="highlight-xml notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="nt">&lt;global&gt;</span>
  <span class="nt">&lt;email_maxperhour&gt;</span>100<span class="nt">&lt;/email_maxperhour&gt;</span>
</pre>
                    </div>
                  </div>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening"
            >
              <span id="herp-derp-grouping"></span>
              <h2>
                <a class="toc-backref" href="#id3"
                  >Alerts for different sensors are appearing in the same email,
                  how do I stop this from happening?</a
                ><a
                  class="headerlink"
                  href="#alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div><p>Read the previous FAQ entry.</p></div>
              </blockquote>
            </div>
            <div class="section" id="how-do-i-ignore-rule-1002">
              <span id="ignore-1002"></span>
              <h2>
                <a class="toc-backref" href="#id4">How do I ignore rule 1002?</a
                ><a
                  class="headerlink"
                  href="#how-do-i-ignore-rule-1002"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Rule 1002 is a catch-all rule. It looks for keywords that
                    are generally considered âbad.â It also means there is not
                    currently a rule that deals with the log message. It is
                    configured to always send an email when itâs triggered, and
                    many users have found it annoying. The best thing to do when
                    you encounter something that triggers rule 1002 is write a
                    rule. Contributing the logs and/or rules back to the project
                    is also encouraged. Unless the application creating the log
                    is an internal application, someone else may find the rule
                    useful.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels"
            >
              <span id="too-many-emails"></span>
              <h2>
                <a class="toc-backref" href="#id5"
                  >I set the &lt;email_alert_level&gt; to 10, why do I keep
                  seeing rules with lower levels?</a
                ><a
                  class="headerlink"
                  href="#i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    Some rules have an option set to force OpenArmor into
                    sending an alert email. This option is
                    <code class="docutils literal notranslate"
                      ><span class="pre"
                        >&lt;options&gt;alert_by_email&lt;/options&gt;</span
                      ></code
                    >. One of these rules is 1002. To ignore these rules you
                    will have to create a rule to specifically ignore it, or
                    overwrite the rule without the
                    <code class="docutils literal notranslate"
                      ><span class="pre">alert_by_email</span></code
                    >
                    option.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="why-are-all-of-my-windows-alerts-showing-up-as-rule-1002"
            >
              <span id="too-much-1002"></span>
              <h2>
                <a class="toc-backref" href="#id6"
                  >Why are all of my Windows alerts showing up as rule 1002?</a
                ><a
                  class="headerlink"
                  href="#why-are-all-of-my-windows-alerts-showing-up-as-rule-1002"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p>
                    This is a known issue when using an older version on the
                    OpenArmor manager and newer versions on the agents. The
                    manager should never be an older version than the agents.
                    Using the same version is ideal, but when that is not
                    possible, the manager should be the newest version.
                  </p>
                </div>
              </blockquote>
            </div>
            <div
              class="section"
              id="i-keep-getting-log-messages-that-start-with-mark-what-do-i-do"
            >
              <span id="mark"></span>
              <h2>
                <a class="toc-backref" href="#id7"
                  >I keep getting log messages that start with
                  <code class="docutils literal notranslate"
                    ><span class="pre">--MARK</span></code
                  >, what do I do?</a
                ><a
                  class="headerlink"
                  href="#i-keep-getting-log-messages-that-start-with-mark-what-do-i-do"
                  title="Permalink to this headline"
                  >Â¶</a
                >
              </h2>
              <blockquote>
                <div>
                  <p><strong>Example:</strong></p>
                  <div class="highlight-console notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="go">OpenArmor HIDS Notification.</span>
<span class="go">2014 Sep 21 08:36:11</span>

<span class="go">Received From: (services01.qrios.com) 10.10.0.01-&gt;OpenArmor-keepalive</span>
<span class="go">Rule: 1002 fired (level 2) -&gt; &quot;Unknown problem somewhere in the system.&quot;</span>
<span class="go">Portion of the log(s):</span>

<span class="go">--MARK--: cB82L!#&#39;zr%lQfGUE))-7Q#Tj4fp+KG=@Wbq^wXiN)7L;ha!JB0kA_mJT5g-j[v_R@TAbk-,/fHEnHjerroRgAIh?OLWJ6LIL/q[Wg-cl#H#n/&amp;(3NDr$@#v8r*l;!b*qru$@YxEE4Zak=(wEqN0JuDlLo!*HtlXKF(3.kQ&amp;wj&amp;+aklF%YNsA&amp;*#Mef)xq&#39;qd@)P+Dz0[jP]70%Q6vqbfbv?fA)D?#bc?_R+6y.i+MdXUzhucx9V#MV($-3uk4!ja!MocJx;D%P=We0Y^DoV&amp;r+fha$rmRA1v$^y4U4cD1&#39;H5T?OF1R3(Hq&#39;H.YcO&#39;3soM/(P2_A@w7K^6G2C=z2#.W2[24=VBXrvVe!5;eKotCM[8W!hE_CB;/!Vk1k&#39;sCov_H[u&#39;(=no*VEH$&#39;@1vVU7zj*I7s0RHD)w@ipX?&amp;@y)X50Q&#39;w#OyN$+$pW?xW_0JYFRwK/g3wIuKc!D#Q*eMg&#39;79/oaURi.j].))JIQ6&amp;!k(O]ZN#lHATidRwRTvhQFQ]6DFiBT;fltbg(OALDi/LlPqkcL5bypK?axVByOGJp+.P(@[p)&#39;j</span>
</pre>
                    </div>
                  </div>
                  <p>
                    This is a keep alive message, sent from an OpenArmor agent
                    to the manager. This prevents the manager from marking the
                    agent as disconnected. These log messages should be filtered
                    out, but sometimes one slips through (this one has the
                    string
                    <code class="docutils literal notranslate"
                      ><span class="pre">erroR</span></code
                    >
                    which may be the cause). These should be safe to ignore.
                  </p>
                </div>
              </blockquote>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
