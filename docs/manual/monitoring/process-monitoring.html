<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Process Monitoring &#8212; OpenArmor</title>
    <link
      rel="stylesheet"
      href="../../../_static/pygments.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/bootstrap-sphinx.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../../../_static/parallax.css"
      type="text/css"
    />
    <script
      id="documentation_options"
      data-url_root="../../../"
      src="../../../_static/documentation_options.js"
    ></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../_static/js/jquery-fix.js"></script>
    <script src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../_static/bootstrap-sphinx.js"></script>
    <link
      rel="author"
      title="About these documents"
      href="../../../about.html"
    />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="File Monitoring" href="file-log-monitoring.html" />
    <link rel="prev" title="Log monitoring/analysis" href="index.html" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-138780766-1");
    </script>

    <script type="text/javascript">
      var _ss = _ss || [];
      _ss.push([
        "_setDomain",
        "https://koi-3QNN51VTHS.marketingautomation.services/net",
      ]);
      _ss.push(["_setAccount", "KOI-4APYNOYP8O"]);
      _ss.push(["_trackPageView"]);
      window._pa = window._pa || {};
      // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
      // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
      // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
      (function () {
        var ss = document.createElement("script");
        ss.type = "text/javascript";
        ss.async = true;
        ss.src =
          ("https:" == document.location.protocol ? "https://" : "http://") +
          "koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0";
        var scr = document.getElementsByTagName("script")[0];
        scr.parentNode.insertBefore(ss, scr);
      })();
    </script>

    <link rel="icon" href="favicon/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div id="navbar" class="navbar navbar-inverse navbar-default">
      <div class="container">
        <div class="navbar-header">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target=".nav-collapse"
          >
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../index.html"
            ><img src="../../../_static/OpenArmor_logo_bare_small.jpg" />
            OpenArmor</a
          >
          <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
        </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://theopenarmor.org/about/">About</a></li>
            <li><a href="https://theopenarmor.org/docs/">Documentation</a></li>
            <li>
              <a href="https://theopenarmor.org/register-for-OpenArmor/"
                >Get OpenArmor+</a
              >
            </li>
            <li><a href="https://theopenarmor.org/downloads/">Downloads</a></li>

            <li class="dropdown globaltoc-container">
              <a
                role="button"
                id="dLabelGlobalToc"
                data-toggle="dropdown"
                data-target="#"
                href="../../../index.html"
                >Site <b class="caret"></b
              ></a>
              <ul
                class="dropdown-menu globaltoc"
                role="menu"
                aria-labelledby="dLabelGlobalToc"
              >
                <ul class="current">
                  <li class="toctree-l1 current">
                    <a class="reference internal" href="../index.html"
                      >Manual</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../faq/index.html"
                      >Frequently asked questions</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../cookbooks/index.html"
                      >User submitted Cookbooks</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/build/index.html"
                      >Build, compile, and not much more</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../development/oRFC/index.html"
                      >oRFC:</a
                    >
                  </li>
                </ul>
                <ul>
                  <li class="toctree-l1">
                    <a class="reference internal" href="../../syntax/index.html"
                      >Syntax and Options</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../formats/index.html"
                      >Output Formats</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../programs/index.html"
                      >Man pages</a
                    >
                  </li>
                  <li class="toctree-l1">
                    <a
                      class="reference internal"
                      href="../../examples/index.html"
                      >Examples</a
                    >
                  </li>
                </ul>
              </ul>
            </li>

            <li>
              <a
                href="index.html"
                title="Previous Chapter: Log monitoring/analysis"
                ><span
                  class="glyphicon glyphicon-chevron-left visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >&laquo; Log monitorin...</span
                >
              </a>
            </li>
            <li>
              <a
                href="file-log-monitoring.html"
                title="Next Chapter: File Monitoring"
                ><span
                  class="glyphicon glyphicon-chevron-right visible-sm"
                ></span
                ><span class="hidden-sm hidden-tablet"
                  >File Monitoring &raquo;</span
                >
              </a>
            </li>
          </ul>

          <form
            class="navbar-form navbar-right"
            action="../../../search.html"
            method="get"
          >
            <div class="form-group">
              <input
                type="text"
                name="q"
                class="form-control"
                placeholder="Search"
              />
            </div>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="section" id="process-monitoring">
            <span id="manual-procmon"></span>
            <h1>
              Process Monitoring<a
                class="headerlink"
                href="#process-monitoring"
                title="Permalink to this headline"
                >¶</a
              >
            </h1>
            <div class="section" id="overview">
              <h2>
                Overview<a
                  class="headerlink"
                  href="#overview"
                  title="Permalink to this headline"
                  >¶</a
                >
              </h2>
              <p>
                We love logs. Inside OpenArmor we treat everything as if it is a
                log and parse it appropriately with our rules. However, some
                information is not available in log files but we still want to
                monitor it. To solve that gap, we added the ability to monitor
                the output of commands via OpenArmor, and treat the output of
                those commands just like they were log files.
              </p>
            </div>
            <div class="section" id="configuration-examples">
              <h2>
                Configuration examples<a
                  class="headerlink"
                  href="#configuration-examples"
                  title="Permalink to this headline"
                  >¶</a
                >
              </h2>
              <div class="section" id="disk-space-utilization-df-h-example">
                <h3>
                  Disk space utilization (df -h) example<a
                    class="headerlink"
                    href="#disk-space-utilization-df-h-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  For example, if you wanted to monitor the disk space
                  utilization, you would need to setup a cron job to dump the
                  output of
                  <code class="docutils literal notranslate"
                    ><span class="pre">df</span>
                    <span class="pre">-h</span></code
                  >
                  to a log file (maybe /var/log/df.log) and configure OpenArmor
                  to look at it.
                </p>
                <p>
                  As of OpenArmor version 2.3 you can monitor commands directly
                  in OpenArmor following configuration (in
                  /var/OpenArmor/etc/OpenArmor.conf):
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>command<span class="nt">&lt;/log_format&gt;</span>
    <span class="nt">&lt;command&gt;</span>df -h<span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  Since we already have a sample rule for df -h included with
                  OpenArmor you would see the following when any partition
                  reached 100%:
                </p>
                <div class="highlight-default notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="o">**</span> <span class="n">Alert</span> <span class="mf">1257451341.28290</span><span class="p">:</span> <span class="n">mail</span> <span class="o">-</span> <span class="n">OpenArmor</span><span class="p">,</span><span class="n">low_diskspace</span><span class="p">,</span>
<span class="mi">2009</span> <span class="n">Nov</span> <span class="mi">05</span> <span class="mi">16</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">21</span> <span class="p">(</span><span class="n">home</span><span class="o">-</span><span class="n">ubuntu</span><span class="p">)</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.0</span><span class="o">-&gt;</span><span class="n">df</span> <span class="o">-</span><span class="n">h</span>

<span class="n">Rule</span><span class="p">:</span> <span class="mi">531</span> <span class="p">(</span><span class="n">level</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Partition usage reached 100% (disk space monitor).&quot;</span>
<span class="n">Src</span> <span class="n">IP</span><span class="p">:</span> <span class="p">(</span><span class="n">none</span><span class="p">)</span>
<span class="n">User</span><span class="p">:</span> <span class="p">(</span><span class="n">none</span><span class="p">)</span>
<span class="n">OpenArmor</span><span class="p">:</span> <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;df -h&#39;</span><span class="p">:</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span> <span class="mi">24</span><span class="n">G</span> <span class="mi">12</span><span class="n">G</span> <span class="mi">11</span><span class="n">G</span> <span class="mi">100</span><span class="o">%</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">backup</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="load-average-uptime-example">
                <h3>
                  Load average (uptime) Example<a
                    class="headerlink"
                    href="#load-average-uptime-example"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  Another example, if you want to monitor the load average, you
                  can configure OpenArmor to monitor the “uptime” command and
                  alert when it is higher than 2, for example:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>command<span class="nt">&lt;/log_format&gt;</span>
    <span class="nt">&lt;command&gt;</span>uptime<span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  And in the rule (in /var/OpenArmor/rules/local_rules.xml):
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;100101&quot;</span> <span class="na">level=</span><span class="s">&quot;7&quot;</span> <span class="na">ignore=</span><span class="s">&quot;7200&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>530<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;match&gt;</span>OpenArmor: output: &#39;uptime&#39;: <span class="nt">&lt;/match&gt;</span>
    <span class="nt">&lt;regex&gt;</span>load averages: 2.<span class="nt">&lt;/regex&gt;</span>
    <span class="nt">&lt;description&gt;</span>Load average reached 2..<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  There are lots of possibilities with this feature. If you have
                  ideas for commands to monitor and rules, please comment.
                </p>
              </div>
              <div
                class="section"
                id="alerting-when-output-of-a-command-changes"
              >
                <h3>
                  Alerting when output of a command changes<a
                    class="headerlink"
                    href="#alerting-when-output-of-a-command-changes"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  If you want to create alerts when a log or the output of a
                  command changes, take a look at the new &lt;check_diff /&gt;
                  option in the rules (available on the latest snapshot).
                </p>
                <p>
                  To demonstrate with an example, we will create a rule to alert
                  when there is a new port open in listening mode on our server.
                </p>
                <p>
                  First, we configure OpenArmor to run the
                  <code class="docutils literal notranslate"
                    ><span class="pre">netstat</span>
                    <span class="pre">-tan</span>
                    <span class="pre">|grep</span>
                    <span class="pre">LISTEN</span></code
                  >
                  command by adding the following to OpenArmor.conf:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>full_command<span class="nt">&lt;/log_format&gt;</span>
    <span class="nt">&lt;command&gt;</span>netstat -tan |grep LISTEN|grep -v 127.0.0.1<span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;/localfile&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  After that, I add a rule to alert when its output changes:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;140123&quot;</span> <span class="na">level=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>530<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;match&gt;</span>OpenArmor: output: &#39;netstat -tan |grep LISTEN<span class="nt">&lt;/match&gt;</span>
    <span class="nt">&lt;check_diff</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;description&gt;</span>Listened ports have changed.<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  Note that we use the
                  <code class="docutils literal notranslate"
                    ><span class="pre">&lt;check_diff</span>
                    <span class="pre">/&gt;</span></code
                  >
                  option. The first time it receives the event, it will store in
                  an internal database. Every time it receives the same event,
                  it will compare against what we have store and only alert if
                  the output changes.
                </p>
                <p>
                  In our example, after configuring OpenArmor, I started netcat
                  to listen on port 23456 and that’s the alert I got:
                </p>
                <div class="highlight-default notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="n">OpenArmor</span> <span class="n">HIDS</span> <span class="n">Notification</span><span class="o">.</span>
<span class="mi">2010</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">19</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">30</span>

<span class="n">Received</span> <span class="n">From</span><span class="p">:</span> <span class="n">XYZ</span><span class="o">-&gt;</span><span class="n">netstat</span> <span class="o">-</span><span class="n">tan</span> <span class="o">|</span><span class="n">grep</span> <span class="n">LISTEN</span><span class="o">|</span><span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">Rule</span><span class="p">:</span> <span class="mi">140123</span> <span class="n">fired</span> <span class="p">(</span><span class="n">level</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Listened ports have changed.&quot;</span>
<span class="n">Portion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>

<span class="n">OpenArmor</span><span class="p">:</span> <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;netstat -tan |grep LISTEN|grep -v 127.0.0.1&#39;</span><span class="p">:</span>
<span class="n">tcp4</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">*.</span><span class="mi">23456</span>           <span class="o">*.*</span>               <span class="n">LISTEN</span>
<span class="n">tcp4</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">*.</span><span class="mi">3306</span>            <span class="o">*.*</span>               <span class="n">LISTEN</span>
<span class="n">tcp4</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">*.</span><span class="mi">25</span>              <span class="o">*.*</span>               <span class="n">LISTEN</span>
<span class="n">Previous</span> <span class="n">output</span><span class="p">:</span>
<span class="n">OpenArmor</span><span class="p">:</span> <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;netstat -tan |grep LISTEN|grep -v 127.0.0.1&#39;</span><span class="p">:</span>
<span class="n">tcp4</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">*.</span><span class="mi">3306</span>            <span class="o">*.*</span>               <span class="n">LISTEN</span>
<span class="n">tcp4</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="o">*.</span><span class="mi">25</span>              <span class="o">*.*</span>               <span class="n">LISTEN</span>
</pre>
                  </div>
                </div>
              </div>
              <div class="section" id="detecting-usb-storage-usage">
                <h3>
                  Detecting USB Storage Usage<a
                    class="headerlink"
                    href="#detecting-usb-storage-usage"
                    title="Permalink to this headline"
                    >¶</a
                  >
                </h3>
                <p>
                  <a
                    class="reference external"
                    href="http://blog.rootshell.be/2010/03/15/detecting-usb-storage-usage-with-OpenArmor/"
                    >Xavier Mertens</a
                  >
                  wrote a very interesting article on Detecting USB Storage
                  Usage with OpenArmor. He used our policy auditing module for
                  that, but I think USB monitoring can be done in a much easier
                  way with our new
                  <a href="#id1"
                    ><span class="problematic" id="id2"
                      >:xml:`check_diff`</span
                    ></a
                  >
                  feature.
                </p>
                <p>
                  To get started, first configure your Windows agents to monitor
                  the USBSTOR registry entry using the reg command:
                </p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;agent_config</span> <span class="na">os=</span><span class="s">&quot;windows&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;localfile&gt;</span>
        <span class="nt">&lt;log_format&gt;</span>full_command<span class="nt">&lt;/log_format&gt;</span>
        <span class="nt">&lt;command&gt;</span>reg QUERY HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR<span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/localfile&gt;</span>
<span class="nt">&lt;/agent_config&gt;</span>
</pre>
                  </div>
                </div>
                <p>Next create a local rule for that command:</p>
                <div class="highlight-xml notranslate">
                  <div class="highlight">
                    <pre><span></span><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;140125&quot;</span> <span class="na">level=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>530<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;match&gt;</span>OpenArmor: output: &#39;reg QUERY<span class="nt">&lt;/match&gt;</span>
    <span class="nt">&lt;check_diff</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;description&gt;</span>New USB device connected<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre>
                  </div>
                </div>
                <p>
                  Now after a few minutes you will see a directory at
                  <code class="docutils literal notranslate"
                    ><span class="pre"
                      >/var/OpenArmor/queue/diff/[agent_name]/[rule_id]</span
                    ></code
                  >
                  with the current snapshot of this command. Once someone adds a
                  new USB device you will get this alert:
                </p>
                <div class="highlight-default notranslate">
                  <div class="highlight">
                    <pre><span></span>** Alert 1268687754.35062: mail  - local,syslog,
2010 Mar 15 18:15:54 (xx-netbook) any-&gt;reg QUERY HKLMSYSTEMCurrentControlSetEnumUSBSTOR
Rule: 140125 (level 7) -&gt; &#39;New USB device connected&#39;
Src IP: (none)
User: (none)
OpenArmor: output: &#39;reg QUERY HKLMSYSTEMCurrentControlSetEnumUSBSTOR&#39;:! REG.EXE VERSION 3.0

HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTOR
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_&amp;Prod_USB_Flash_Memory&amp;Rev_5.00
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Generic&amp;Prod_Flash_Disk&amp;Rev_8.0
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Hitachi&amp;Prod_HTS543225L9A300&amp;Rev_
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_LEXAR&amp;Prod_JD_FIREFLY&amp;Rev_1100
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_SAMSUNG&amp;Prod_HM160JC&amp;Rev_0000
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Sony&amp;Prod_DSC&amp;Rev_1.00
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_TomTom&amp;Prod_ONE_XXL_IQ_Rts
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_USB_2.0&amp;Prod_USB_Flash_Drive&amp;Rev_0.00

Previous output:

OpenArmor: output: &#39;reg QUERY HKLMSYSTEMCurrentControlSetEnumUSBSTOR&#39;:
! REG.EXE VERSION 3.0
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTOR
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_&amp;Prod_USB_Flash_Memory&amp;Rev_5.00
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Generic&amp;Prod_Flash_Disk&amp;Rev_8.07
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Hitachi&amp;Prod_HTS543225L9A300&amp;Rev_
HKEY_LOCAL_ACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_SAMSUNG&amp;Prod_HM160JC&amp;Rev_0000
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_Sony&amp;Prod_DSC&amp;Rev_1.00
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_TomTom&amp;Prod_ONE_XXL_IQ_Rts
HKEY_LOCAL_MACHINESYSTEMCurrentControlSetEnumUSBSTORDisk&amp;Ven_USB_2.0&amp;Prod_USB_Flash_Drive&amp;Rev_0.00
</pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="pull-right">
          <a href="#">Back to top</a>
        </p>
        <p>
          &copy; Copyright 2010-2021, OpenArmor Project Team.<br />
          OpenArmor <b>OpenArmor.net</b> domain owned and maintained by
          <a href="https://theopenarmor.org" target="_blank"
            >OpenArmor Foundation</a
          ><br />
          Home page graphics courtesy of
          <a href="https://pixabay.com" target="_blank">pixabay</a>
        </p>
      </div>
    </footer>
  </body>
</html>
